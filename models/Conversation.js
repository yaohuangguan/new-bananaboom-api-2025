import { Schema, model } from 'mongoose';

const ConversationSchema = new Schema(
  {
    // å…³è”ç”¨æˆ·
    user: { type: Schema.Types.ObjectId, ref: 'users', required: true },

    // ğŸ”¥ æ ¸å¿ƒï¼šå‰ç«¯ç”Ÿæˆçš„ UUIDï¼Œç”¨äºä¸²è” Chat è®°å½•
    sessionId: { type: String, required: true, unique: true, index: true },

    // ä¼šè¯æ ‡é¢˜ (AI è‡ªåŠ¨ç”Ÿæˆ)
    title: { type: String, default: 'æ–°å¯¹è¯' },

    // æ ‡è®°æ˜¯å¦å·²ç»è‡ªåŠ¨ç”Ÿæˆè¿‡æ ‡é¢˜ (é¿å…åå¤ä¿®æ”¹)
    isTitleAutoGenerated: { type: Boolean, default: false },

    // ç”¨äºåˆ—è¡¨æ’åºï¼šæ¯æ¬¡è¯´è¯éƒ½ä¼šæ›´æ–°è¿™ä¸ªæ—¶é—´
    lastActiveAt: { type: Date, default: Date.now }
  },
  { timestamps: true }
);

export default model('conversation', ConversationSchema);
